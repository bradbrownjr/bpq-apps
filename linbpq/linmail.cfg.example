# LinMail Configuration Example for Forms Import
# ===============================================
# This is an example forwarding configuration for automatically importing
# messages from the forms.py application into the BPQ BBS.
#
# To use this configuration:
# 1. Access your BPQ32 web interface (typically http://localhost:8080)
# 2. Navigate to Mail Management -> Forwarding Configuration
# 3. Create a new forwarding record with your BBS callsign
# 4. Set the ConnectScript to: IMPORT infile DELETE
# 5. Configure the forward interval based on your needs
#
# The linmail.cfg file is automatically generated by the BPQ web UI.
# Do not edit it manually - use the web interface instead.

# Example forwarding record for forms import:
# Replace WS1EC with your BBS callsign

  WS1EC :
  {
    # No destination needed for local import
    TOCalls = "";
    
    # CRITICAL: This imports messages from the infile and deletes it after processing
    ConnectScript = "IMPORT infile DELETE";
    
    # Leave these empty for local import
    ATCalls = "";
    HRoutes = "";
    HRoutesP = "";
    
    # Forward timing - adjust based on your needs:
    # Active incident/net: 300 seconds (5 minutes)
    # Normal operations: 900-1800 seconds (15-30 minutes)
    # Low activity: 3600 seconds (60 minutes)
    FWDTimes = "";
    
    # Essential settings
    Enabled = 1;                    # Enable this forwarding record
    RequestReverse = 1;             # Allow reverse forwarding
    AllowBlocked = 1;               # Process messages even if blocked
    AllowCompressed = 1;            # Support compressed forwarding
    UseB1Protocol = 0;              # Don't use B1 protocol
    UseB2Protocol = 1;              # Use B2 protocol
    SendCTRLZ = 0;                  # Don't send CTRL-Z
    FWDPersonalsOnly = 0;           # Forward all message types
    FWDNewImmediately = 0;          # Wait for interval (not immediate)
    
    # Forward interval in seconds (300 = 5 minutes)
    FwdInterval = 300;
    
    # Reverse forward interval (0 = disabled for local import)
    RevFWDInterval = 0;
    
    # Maximum FBB block size
    MaxFBBBlock = 10000;
    
    # Connection timeout in seconds
    ConTimeout = 120;
    
    # Your BBS hierarchical address
    # Format: CALL.#CITY.STATE.COUNTRY.CONTINENT
    BBSHA = "WS1EC.#CUMB.ME.USA.NOAM";
  };

# How it works:
# =============
# 1. Users fill out forms via the forms.py application
# 2. Completed forms are appended to linbpq/infile in BPQ message format
# 3. Every FwdInterval seconds, BPQ runs the IMPORT command
# 4. Messages are imported into the BBS mail queue
# 5. The infile is deleted after successful import
# 6. BPQ delivers messages to recipients via normal forwarding

# Troubleshooting:
# ================
# - If messages aren't importing, check that Enabled = 1
# - Verify the infile exists in the same directory as the linbpq executable
# - Check BPQ logs for import errors: tail logLatest_BBS.txt
# - You can manually import via: Actions -> Import Messages in web UI
# - For testing, use a shorter FwdInterval (e.g., 60 seconds)

# Related Files:
# ==============
# - apps/forms.py: The forms application that creates messages
# - linbpq/infile: The message queue file (auto-created, auto-deleted)
# - linbpq/bpq32.cfg: Main BPQ configuration with APPLICATION definition
# - etc/services: Port definition for the forms service
# - etc/inetd.conf: Service startup configuration
